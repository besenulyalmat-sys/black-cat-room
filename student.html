<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Black Cat Room ‚Äì Student</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:linear-gradient(135deg,#0f0f0f,#141414,#1a1f1c);
  color:#00ff9d;
}
.container{width:90%;margin:auto;margin-top:30px;}
input,textarea{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  background:#111;
  color:#00ff9d;
  border:1px solid #00ff9d;
  border-radius:8px;
}
button{
  padding:8px 15px;
  background:#00ff9d;
  border:none;
  border-radius:8px;
  font-weight:bold;
  cursor:pointer;
}

@keyframes glow{
  0%{text-shadow:0 0 5px #00ff9d;}
  50%{text-shadow:0 0 20px #00ff9d;}
  100%{text-shadow:0 0 5px #00ff9d;}
}
.rank-animate{
  animation:glow 1s ease-in-out;
}
</style>
</head>

<body>
<div class="container">

<h2>üêæ Black Cat Room ‚Äì Student</h2>
<div id="catAvatar" style="text-align:center; margin:20px 0;">
  <img id="catImage" src="cat-level1.jpg.jpg" 
       style="width:180px; border-radius:20px; transition:0.4s;">
</div>

<input id="roomCode" placeholder="Room code...">
<input id="studentName" placeholder="Your name...">
<button onclick="joinRoom()">Join</button>

<h3>Current Task:</h3>
<div id="task">Waiting...</div>

<textarea id="answerInput" placeholder="Write answer..."></textarea>
<button onclick="submitAnswer()">Submit</button>

<div id="rankDisplay" style="margin-top:20px;font-size:18px;"></div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, onValue, set } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig={
  apiKey:"AIzaSyBsrZ_k2K8u0ybvkEDoEywD_QWzmDTKjyY",
  authDomain:"black-cat-room.firebaseapp.com",
  databaseURL:"https://black-cat-room-default-rtdb.europe-west1.firebasedatabase.app",
  projectId:"black-cat-room",
  storageBucket:"black-cat-room.firebasestorage.app",
  messagingSenderId:"80028312826",
  appId:"1:80028312826:web:ee918db88c71a0c1335543"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);

let currentRoom="";

// ===== JOIN =====
window.joinRoom=function(){
  const room=document.getElementById("roomCode").value;
  const name=document.getElementById("studentName").value;
  if(!room||!name) return alert("Enter room and name");

  currentRoom=room;

  onValue(ref(db,"rooms/"+room+"/task"),snapshot=>{
    document.getElementById("task").innerText =
      snapshot.val() || "Waiting...";
  });

onValue(scoreRef, (snapshot) => {
  const points = snapshot.val();
  if(points == null) return;

  let rank = "–ù–æ–≤–∏—á–æ–∫";
  let catImg = "cat-level1.jpg.jpg";

  if (points >= 3) {
    rank = "üê± –ö–æ—Ç—ë–Ω–æ–∫";
    catImg = "cat-level2.jpg.jpg";
  }

  if (points >= 7) {
    rank = "üòº –û—Ö–æ—Ç–Ω–∏–∫";
    catImg = "cat-level3.jpg.jpg";
  }

  if (points >= 10) {
    rank = "üëë –ö–æ—Ä–æ–ª—å –ö–æ—Ç";
    catImg = "cat-king.jpg.jpg";
  }

  document.getElementById("rankDisplay").innerText =
    "–û—á–∫–∏: " + points + " / 10\n–£—Ä–æ–≤–µ–Ω—å: " + rank;

  document.getElementById("catImage").src = catImg;
});


    block.classList.add("rank-animate");
    setTimeout(()=>block.classList.remove("rank-animate"),1000);
  });
};

// ===== SUBMIT =====
window.submitAnswer=function(){
  const name=document.getElementById("studentName").value;
  const answer=document.getElementById("answerInput").value;

  if(!currentRoom||!name||!answer)
    return alert("Fill all fields");

  set(ref(db,"rooms/"+currentRoom+"/answers/"+name),answer);
  alert("Answer sent");
};
</script>

</body>
</html>
